import io
import base64

# ===========================
# 📥 DOWNLOAD BUTTONS SECTION
# ===========================

# 📁 Download CSV of metrics
csv_data = df_metrics.to_csv(index=False).encode('utf-8')
st.download_button(
    label="📥 Download Metrics CSV",
    data=csv_data,
    file_name="model_performance_metrics.csv",
    mime='text/csv'
)

# 📁 Download Classification Reports for all models
report_text = ""
for name in selected_models:
    clf = model_options[name]
    clf.fit(X_train_scaled, y_train)
    y_pred = clf.predict(X_test_scaled)
    report = classification_report(y_test, y_pred, target_names=["Normal", "Abnormal"])
    report_text += f"=== {name} ===\n{report}\n\n"

st.download_button(
    label="📥 Download Classification Reports (.txt)",
    data=report_text,
    file_name="classification_reports.txt",
    mime="text/plain"
)
